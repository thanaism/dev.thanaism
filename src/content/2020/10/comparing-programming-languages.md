---
layout: post
title: プログラミング言語の基本文法を比較する
image: ../../img/paulo-brandao-YLgTmdb7r1o-unsplash.jpg
author: [Thanai]
date: 2020-10-29T17:00:00.000Z
draft: false
tags:
  - programming
excerpt: この処理この言語だとどう書くんだっけ？が多いので
---

## はじめに

いきなり網羅的には比較できないと思うので、今後、継続的に拡充していくつもりの記事です。  
取り急ぎは、一番得意な Python をベースに js、C++を作り上げたい次第。  
読者層を考えて VBA も書こうかと思いますが、機能の貧弱さに悲しくなりそう。

## 算術演算

|    言語    | 加算  | 減算  | 乗算  |   冪乗   | 除算  | 整数除算 |   剰余    |
| :--------: | :---: | :---: | :---: | :------: | :---: | :------: | :-------: |
|   Python   | `a+b` | `a-b` | `a*b` |  `a**b`  | `a/b` |  `a//b`  |   `a%b`   |
| JavaScript | `a+b` | `a-b` | `a*b` |  `a**b`  | `a/b` | `a/b|0`  |   `a%b`   |
|    C++     | `a+b` | `a-b` | `a*b` | なし[^1] | `a/b` |  `a/b`   |   `a%b`   |
|    VBA     | `a+b` | `a-b` | `a*b` |  `a^b`   | `a/b` |  `a¥b`   | `a Mod b` |

[^1]: `std::pow(a,b)`を使用する。

VBA では冪乗に`^`使う点に要注意でしょう（多くの言語で`^`はビット排他的論理和`XOR`）。

## ビット演算

### シフト

|    言語    | 左シフト | 右シフト |
| :--------: | :------: | :------: |
|   Python   |  `a<<b`  |  `a>>b`  |
| JavaScript |  `a<<b`  |  `a>>b`  |
|    VBA     |   なし   |   なし   |

VBA にはシフト演算をする演算子はありません。

### 基本

|    言語    |   NOT   |    AND    |    OR    |    XOR    |
| :--------: | :-----: | :-------: | :------: | :-------: |
|   Python   |  `~a`   |   `a&b`   |  `a|b`   |   `a^b`   |
| JavaScript |  `~a`   |   `a&b`   |  `a|b`   |   `a^b`   |
|    VBA     | `Not a` | `a And b` | `a Or b` | `a Xor b` |

VBA は論理演算子と同じものを使うので括弧をたくさん使う必要があり扱いにくいです。
（比較演算子より論理演算子のほうが演算優先順位が低いため）

### 特殊

|    言語    |    EQV    |    IMP    |
| :--------: | :-------: | :-------: |
|   Python   | `~(a^b)`  |  `~a|b`   |
| JavaScript | `~(a^b)`  |  `~a|b`   |
|    VBA     | `a Eqv b` | `a Imp b` |

なぜか VBA には`Eqv`と`Imp`があります。  
Python と JavaScript の欄を見ればわかりますが他の演算記号を組み合わせて表現可能です。

### VBA ビット演算について

VBA のビット演算については、シフトもなくサポート外っぽいので本当に正しく評価されるかは未検証です。  
一応軽く試してみた感じでは大丈夫そう。厳密にやるなら全部`CInt`でキャストとかしないとダメかも。

```vb
Rem 適当チェック用プロシージャ
Sub test()
    Dim i, j
    For i = -10 To 10
        For j = -10 To 10
            Dim ni As Long, nj As Long
            ni = Not i
            nj = Not j
            Debug.Assert (i Xor j) = Not (i Eqv j)
            Debug.Assert (ni Or j) = (i Imp j)
            Debug.Assert (ni And nj) = Not (i Or j)
            Debug.Assert ((ni And j) Or (i And nj)) = (i Xor j)
        Next j
    Next i
End Sub
```

## 関係演算

|    言語    |    等価    |   厳密等価   |     小なり大なり     | 存在 |  同一   |  インスタンス  |
| :--------: | :--------: | :----------: | :------------------: | :--: | :-----: | :------------: |
|   Python   | `==`, `!=` |     なし     | `<`, `<=`, `>`, `>=` | `in` |  `is`   | `isinstance()` |
| JavaScript | `==`, `!=` | `===`, `!==` | `<`, `<=`, `>`, `>=` | `in` | `.is()` |  `instanceof`  |
|    VBA     | `=`, `<>`  |     なし     | `<`, `<=`, `>`, `>=` | なし |  `Is`   |    なし[^2]    |

C++は自分の理解がまだ追いついていないのでいったん省きます。  
`std::find()`がどういうクラスなら適用可能なのか、とか、ポインタ変数と参照変数のどちらを使って同一を確認すべきか、とかが普段使わないからまったくわかりません。

[^2]: `TypeName`を使用して判定するしかない。また、VB にある`TypeOf`も VBA では使用できない。

## 演算子の優先順位

VBA の演算子優先順は、`算術演算子` → `文字列連結&`→ `比較演算子` → `論理演算子`です。  
詳しくは[Docs](https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/operator-precedence)でも見てください。

以下では、忘れがちな Python と JavaScript で主に異なる点に注目して書きます。

### ビット演算子

優先順は Python、JavaScript ともに以下です。

`~`→`<<`,`>>`→`&`→`^`→`|`（左が優先度高）

まあ、これは基本に忠実です。上述のビット演算の項での記述を見ればどういうことかよく分かるかと思います。

### 冪乗`**`

Ptyhon では冪乗`**`が単項演算子`+`, `-`, `~`より優先。JavaScript は逆になっています。

### 関係演算子

Python では関係演算子`in`, `not in`, `is`, `is not`, `<`, `<=`, `>`, `>=`, `!=`, `==`はすべて同位。  
JavaScript では、`<`, `<=`, `>`, `>=`, `in`, `instanceof`が`==`, `!=`, `===`, `!==`より上位。
C++もほぼ同じで、`<`, `<=`, `>`, `>=`は`==`, `!=`より上位。

### 論理否定

論理否定`Not`は Python では比較演算子より下位。  
JavaScript や C++では論理否定`!`はビット否定`~`と同位。

### インクリメント・デクリメント

Python にはインクリメント用の演算子はありません。  
JavaScript や C++ では後置演算子`x++`, `x--`のほうが前置演算子`++x`, `--x`より優先になります。

### その他

それ以外は微妙に異なる部分もありますが、実用上は同じと捉えておいて良さそうです。

## 追記予定

本当は配列や連結リストについても書きたかったですが、思ったより書くのに時間がかかったので後回しにします。
