---
layoutlayout: post
title: 圏論とHaskellのつながり
image: ../../img/francisco-requena-A9tP39BIn28-unsplash.jpg
author: [Thanai]
date: 2021-05-23T23:00:00.000+09:00
draft: false
tags:
  - Weekly Report
excerpt: 週報 05/17-05/23
---

## 今回から週報にも固有のタイトルを付ける

今まで無機質な「週報」というタイトルで書いてきたが、あとから内容もわからないし、誰の需要にもリーチできないのでテーマに応じたタイトルをつけることにする（いつの週報かはexcerptに記載する）。

## とにもかくにもHaskell

Haskellと圏論のつながりなどを理解しはじめた。

業務でもreactive programmingな話題がチラホラしているので、関数型のパラダイムを確実に理解していきたい。

現時点でのHaskellと圏論についての理解を簡単に述べる。

まず、関数型プログラミングでは**参照透過性のある純粋関数でプログラムを書きたい**という前提がある。

参照透過性のある純粋関数というのは、めっちゃ砕いて言えば同じ入力に対して常に同じ結果を返すということ。つまりはすべての操作は冪等にしたい。

UNIX哲学にも通ずるところがあるが、**ミニマムで単一機能な関数を複数組み合わせてほしい結果を得ましょうね**というのが関数型プログラミングの思想の根底にある。

それで、そういうことをしやすくするためにカリー化だったりをするわけだ。

が、現実問題としてそもそも**入力**という行為からして冪等ではない。Pythonでいえば`input()`は常に同じ結果を返さない。当たり前だ。逆にいつも同じだったら単なるリテラルでしかない。

そこで、関数型プログラミングでは、入力のように冪等にできない**不純**な部分とそれ以外の**純粋**な部分をキッチリ区分けしようという話になる。

しかも単に分けるだけではダメで、たとえば入力に対して「この関数は2以上50以下の整数を対象にしているから、そうでない場合のエラー処理を入れよう」みたいなことをやってしまうと、関数は肥大化し参照透過性は台無しになる。

**整数かもしれないし、そうでないかもしれない値**に対して、**整数入力を前提としたミニマムな関数**を**安全**に使えることが理想だ。

本当にそんなことができるのか、と思ってしまうが、それを実現するための仕組みがモナドやアプリカティブということになる。

そして、このHaskellに出てくるモナドを筆頭とした型で表現される世界は、実は圏論によって体系的な整理をすることができる。しかし、実際に大事なのは**モナドによって何ができるか**であり、圏論を理解しなければHaskellを使えないということではけっしてなさそうだ。

たとえばよく言われるのがモナドは「[自己関手の圏におけるモノイド対象][モナド]」だというのがあるが、この字面からモナドの便利さに気付くのは不可能に近いのではないか。

どちらかというと`(>>=) :: (Monad m) => m a -> (a -> mb) -> mb`という操作ができるようにしたいというのが先にあって、「これってどうなってればできるんだっけ？　ああ、それは圏論でいうところのホニャララを満たせば常に実現できるね、はいハッピー」という感じだと思う。

まあ、まだ少し文献を読んだ程度で圏論を知らないどころかロクにHaskellでプログラムも書いていない人間なので上記が間違っている可能性は多分にあるのだけど、少なくとも現時点ではこう理解している。

[モナド]: https://south37.hatenablog.com/entry/2014/04/20/%E3%83%A2%E3%83%8A%E3%83%89%E3%80%81%E3%81%82%E3%82%8B%E3%81%84%E3%81%AF%E8%87%AA%E5%B7%B1%E9%96%A2%E6%89%8B%E3%81%AE%E5%9C%8F%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%83%A2%E3%83%8E%E3%82%A4%E3%83%89

## 先週との比較

いちおう週報なので進捗表をば。

以前[JMESPathノック][jp]を書いた際に`details`タグまわりのスタイルをちゃんと調整したので、積極的に使っていくことにする。

[jp]: https://dev.thanaism.com/2021/05/jmespath-knocks/

<details><summary>進捗表</summary></div>

前回からの変更部分は太字。個人的な優先度高い順にソートした表。
終わったものは消している。

| what                 | asis                       | tobe/comment                 |
| :------------------- | :------------------------- | :--------------------------- |
| 家族サービス         | **娘の体調が優れず**       | **妻と運用でカバー**         |
| すごいHaskell        | **おおむね読了**           | 関数型完全に理解する         |
| **Haskell**          | **次は手を動かす**         | **典型90問をHaskellで**      |
| **圏論**             | **[これ][圏論]を読んだ**   | **圏論そこそこ理解する**     |
| Rust                 | **Haskell効果実感中**      | 関数型らしく書けるようになる |
| 競プロレート向上     | Highest 858                | 水色                         |
| 典型90問             | **星4までちゃんと追記中**  | 問題追加時に追記＆星5もやる  |
| 社内活動             | **spring-webflux実践中**   | 頂点に君臨する               |
| **ブログ機能UP**     | **CSS調整ほか**            | **これも記事にしたい**       |
| 収益記事             | 乾燥機で書きたい           | 3000pv/月くらい必要？        |
| 競プロ精選100問      | #14で停滞                  | 1日1問くらいは解きたい       |
| 数学ガール           | 確率編を読み始めた         | 面白いのでいろいろ読みたい   |
| オライリーRust本     | ほんの少し読んだ           | 読む                         |
| 関数型JavaScript     | 半分以上読んだ             | Haskell本を先に              |
| Raku(Perl)           | こたつがめさん配信で興味   | 詳説 正規表現にも絡む        |
| LINUC                | 少しやりたい気分に         | 上半期には取得               |
| けんちょん本の復習   | グラフのあたり弱い         | すべてソラで書ける状態       |
| ネットワークの本     | 積読の本が良書だと紹介あり | 読破し内容理解する           |
| MCP資格              | **無料券がそろそろ期限**   | できればコンプリートしたい   |
| K8s完全ガイド        | 必要になり少し読んだ       | K8s完全に理解する            |
| Octave               | こたつがめさん配信で興味   | 冷静になると優先度は低い     |
| しくみがわかるK8s    | 中盤で停滞                 | K8s完全に理解する            |
| 実践コンテナ入門     | 中盤で停滞                 | Docker完全に理解する         |
| CKA/CKAD             | 何もやっていない           | 上半期には取得               |
| マネジメントの会得   | なにもやっていない         | 組織運営で優秀層に入る       |
| PowerShell完全ガイド | 序盤で停滞                 | PS完全に理解する             |
| アプリ個人制作       | 知識ばかりで成果物がない   | できるだけ早く試作を作成する |
| ブログ               | アクセス数は少ない         | 独自ドメインで10,000PV/M     |
| 収入源としてのブログ | わりと戻ってきた           | 月に10万円の大台を突破したい |
| TwitterフォロワーUP  | 600人ちょい                | 1000人突破                   |

[圏論]: https://bitterharvest.hatenablog.com/archive/category/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9E%E3%83%BC%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AE%E5%9C%8F%E8%AB%96%20%28%E5%88%9D%E7%B4%9A%E7%B7%A8%EF%BC%9A%E5%9C%8F%E8%AB%96%E3%81%A8Haskell%29

</div></details>

## おわりに

関数型の再帰的な世界観にどっぷり浸かって、多角的な解決手法が脳みそにパパパっと浮かぶようにしたい。
